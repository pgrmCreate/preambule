<div ng-controller="NavbarCtrl">

  <div class="animated" ng-class="{fadeInFast : display_modal, fadeOutFast: !display_modal}"
       ng-click="display_modal = false; display_login = false; modal_write_preambule=false;">
  </div>



  <div class="modal-container" ng-class="{'dp-none' : !modal_write_preambule}" ng-click="show_preambule=false;">
    <div class="modal col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"
         ng-class="{'dp-block' : modal_write_preambule}" style="background: #eef">
      <div>
    <span class="glyphicon glyphicon-remove close_window"
          ng-click="modal_write_preambule=false; display_modal = false;"></span>
        <form class="form-horizontal"
              enctype='multipart/form-data'
              ng-upload
              ng-submit="preambuleSave(newPreambule);">
          <fieldset>
            <!-- Form Name -->
            <legend style="width: 95%;">Ajout d'un nouveau préambule</legend>

            <!-- Text input-->
            <div class="form-group">
              <div class="col-md-4 col-md-offset-2">
                <input ng-model="newPreambule.titre"
                       id="titre" name="titre" type="text"
                       placeholder="Titre du préambule" class="form-control input-md">
              </div>
            </div>

            <!-- Text input-->
            <div class="form-group">
              <div class="col-md-4 col-md-offset-2">
                <textarea placeholder="Courte description" ng-model="newPreambule.description"
                          class="form-control" id="content" name="content"
                          ng-change="charaRemaining = 140 - newPreambule.description.length;"
                          style="height: 6em;" maxlength="140" ng-init="charaRemaining = 140;"></textarea>
                <span class="help-block" style="display: inline-block;">facultatif</span>
                <span style="margin-left: 1em;"><b>{{charaRemaining}}</b> caractères restants</span>
              </div>
            </div>

            <!-- Textarea -->
            <div class="form-group">
              <div class="col-md-8 col-md-offset-2">
                <textarea placeholder="Preambule de {{newPreambule.auteur}}" ng-model="newPreambule.content"
                          class="form-control" style="height: 400px; overflow-y: scroll;"
                          id="content" name="content"></textarea>
              </div>
            </div>

            <div class="form-group">
              <div class="col-md-8 col-md-offset-2">
                <p style="margin-bottom: 0.5em;">Selectionnez votre couverture</p>
                <input style="margin-bottom: 1.5em;"
                       type="file" ng-file-select="onFileSelect($files)">
                <img class="col-md-3" id="blah" src="../../images/navbar/image-add.png" alt="" style="background: lightsteelblue;"/>
              </div>
            </div>

            <div class="form-group">
              <div class="col-md-6 col-md-offset-2">

                <input class="col-md-8" ng-model="searchTag" type="text"
                       placeholder="Tags" class="form-control input-md"
                       style="height: 2em;" id="tagLoad">
            <span style="background: white; padding: 0; height: 2em;
            border-radius: 0 0.5em 0.5em 0; border-left: none;
            vertical-align: top; padding-left: 0.5em;"
                  class="col-md-4 btn btn-default"
                  ng-click="legalPushTag(searchTag); searchTag='';">
              Ajouter</span>


                <div class="listing_tags">
                  <div class="btn btn-default"
                       style="margin-left: 1em; margin-top: 1em"
                       ng-repeat="tag in newPreambule.tags track by $index"
                       ng-click="removeTag($index)">
                    <span class="glyphicon glyphicon-remove"></span>
                    {{tag}}
                  </div>
                </div>
              </div>

            </div>
            <div class="col-md-6 col-md-offset-2">
              <button class="btn btn-primary"
                      style="padding: 1em; font-size: 1.3em; margin: 20px 0 100px 0; clear: both;">
                Publier!
              </button>
            </div>
          </fieldset>
        </form>
      </div>

    </div>
  </div>

  <div class="navbar navbar-default navbar-static-top"
       style="z-index: 4; box-shadow: 0px 3px 15px 0px rgba(50, 50, 50, 0.18);">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>

    <div class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="/" target="_self">Préambules</a></li>
        <li><a href="auteurs" target="_self">Auteurs</a></li>
        <!--<li><a href="preambules">Les préambules</a></li>-->
        <!--<li><a href="ecrire">Ecrire</a></li>-->
        <li><a href="bibliotheque" target="_self">Bibliothèque</a></li>
      </ul>

      <a class="navbar-brand" href="#" target="_self" style="padding: 0.2em; left: 45%; position: absolute;">
        <img src="../../images/navbar/logo.png" style="height: 100%;">
      </a>
      <ul class="nav navbar-nav navbar-right" style="margin-right: 0;">

        <li style="cursor: pointer;"
            ng-hide="currentUser">
          <a  ng-click="display_login = true; display_modal = true;">
            se connecter</a>
        </li>
        <li style="cursor: pointer; padding: 0; border: 1px solid #ddd;
        margin-top: 7px;"
            ng-click="write_newPreambule()"
            ng-show="currentUser">
          <img style="width: 3em; height: 38px; border-right: 1px dotted #aaa; background: #eef; padding: 0.25em;"
               src="../../images/general_small_elements/publish.png">
          <div style="display: inline-block;
          height: 37px; vertical-align: top; margin-left: -0.25em;">
            <button class="btn btn-primary"
                    style="width: 100%; padding-top: 10px; display: inline-block; margin: 0;
                 border-radius: 0 0.25em 0.25em 0;">
              Publier un préambule
            </button>
          </div>
        </li>
        <li style="cursor: pointer;"><a
            ng-click="display_login = true; display_modal = true;"
            ng-show="currentUser">
          {{currentUser.name}}</a>
        </li>


        <li style="margin-right: 0.5em;">
          <a href="#about">à propos</a>
        </li>
      </ul>
    </div>
  </div>

  <div style="background: RGBA(0,0,0,0.2); position: absolute; width: 100vw; height: 100vh; top: 0;
  z-index: 8; " ng-show="display_login" ng-click="display_login=false;"></div>
  <div id="modal_login" ng-show="display_login"
       class="display_modal">

    <h1>Connexion</h1>
    <div ng-include="'partials/login'"></div>
  </div>

</div>

